import numpy as np

from .earth_model import OneDModel
from .const import R_EARTH

# Default parameters for isotropic PREM
r_earth = R_EARTH
bps = np.array(
    [
        0.0,
        1221.5,
        3480.0,
        3630.0,
        5600.0,
        5701.0,
        5771.0,
        5971.0,
        6151.0,
        6291.0,
        6346.6,
        6356.0,
        6371.0,
    ]
)
density_params = np.array(
    [
        [13.0885, 0.0000, -8.8381, 0.0000],
        [12.5815, -1.2638, -3.6426, -5.5281],
        [7.9565, -6.4761, 5.5283, -3.0807],
        [7.9565, -6.4761, 5.5283, -3.0807],
        [7.9565, -6.4761, 5.5283, -3.0807],
        [5.3197, -1.4836, 0.0000, 0.0000],
        [11.2494, -8.0298, 0.0000, 0.0000],
        [7.1089, -3.8045, 0.00002, 0.0000],
        [2.6910, 0.6924, 0.0000, 0.0000],
        [2.6910, 0.6924, 0.0000, 0.0000],
        [2.9000, 0.0000, 0.0000, 0.0000],
        [2.6000, 0.0000, 0.0000, 0.0000],
    ]
)
density_params[:, 0] = density_params[:, 0] * 1000.0
density_params[:, 1] = (density_params[:, 1] * 1000.0) / r_earth
density_params[:, 2] = (density_params[:, 2] * 1000.0) / (r_earth**2)
density_params[:, 3] = (density_params[:, 3] * 1000.0) / (r_earth**3)
vp_params = np.array(
    [
        [11.2622, 0.0000, -6.3640, 0.0000],
        [11.0487, -4.0362, 4.8023, -13.5732],
        [15.3891, -5.3181, 5.5242, -2.5514],
        [24.9520, -40.4673, 51.4832, -26.6419],
        [29.2766, -23.6027, 5.5242, -2.5514],
        [19.0957, -9.8672, 0.0000, 0.0000],
        [39.7027, -32.6166, 0.0000, 0.0000],
        [20.3926, -12.2569, 0.0000, 0.0000],
        [4.1875, 3.9382, 0.0000, 0.0000],
        [4.1875, 3.9382, 0.0000, 0.0000],
        [6.8000, 0.0000, 0.0000, 0.0000],
        [5.8000, 0.0000, 0.0000, 0.0000],
    ]
)
vs_params = np.array(
    [
        [3.6678, 0.0000, -4.4475, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000],
        [6.9254, 1.4672, -2.0834, 0.9783],
        [11.1671, -13.7818, 17.4575, -9.2777],
        [22.3459, -17.2473, -2.0834, 0.9783],
        [9.9839, -4.9324, 0.0000, 0.0000],
        [22.3512, -18.5856, 0.0000, 0.0000],
        [8.9496, -4.4597, 0.0000, 0.0000],
        [2.1519, 2.3481, 0.0000, 0.0000],
        [2.1519, 2.3481, 0.0000, 0.0000],
        [3.9000, 0.0000, 0.0000, 0.0000],
        [3.2000, 0.0000, 0.0000, 0.0000],
    ]
)
# Turn range of polynomials from 0 - 1 to 0 - r_earth
vp_params[:, 1] = vp_params[:, 1] / r_earth
vp_params[:, 2] = vp_params[:, 2] / (r_earth**2)
vp_params[:, 3] = vp_params[:, 3] / (r_earth**3)
# Turn range of polynomials from 0 - 1 to 0 - r_earth
vs_params[:, 1] = vs_params[:, 1] / r_earth
vs_params[:, 2] = vs_params[:, 2] / (r_earth**2)
vs_params[:, 3] = vs_params[:, 3] / (r_earth**3)
q_kappa_params = np.array(
    [
        1327.7,
        57823.0,
        57823.0,
        57823.0,
        57823.0,
        57823.0,
        57823.0,
        57823.0,
        57823.0,
        57823.0,
        57823.0,
        57823.0,
    ]
)
q_mu_params = np.array(
    [84.6, np.inf, 312.0, 312.0, 312.0, 143.0, 143.0, 143.0, 80.0, 600.0, 600.0, 600.0]
)

PREM = OneDModel(
    breakpoints=bps,
    density_params=density_params,
    vp_params=vp_params,
    vs_params=vs_params,
    q_mu_params=q_mu_params,
    q_kappa_params=q_kappa_params,
    r_earth=r_earth,
)